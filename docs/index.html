<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TSS sequencing data analysis • TSSr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="TSS sequencing data analysis">
<meta property="og:description" content="TSSr package provides a comprehensive workflow on TSS data starts from 
    identification of accurate TSS locations, clustering TSSs within small genomic 
    regions corresponding to core promoters, and transcriptional activity quantifications, 
    as well as specialized downstream analyses including core promoter shape, cluster 
    annotation, gene differential expression, core promoter shift. TSSr can take 
    multiple formats of files as input, such as Binary Sequence Alignment Mao (BAM) 
    files (single-ended or paired-ended), Browser Extension Data (bed) files, BigWig 
    files, ctss files or tss tables. TSSr also generates various types of TSS or core 
    promoter track files which can be visualized in the UCSC Genome Browser or Integrative 
    Genomics Viewer (IGV). TSSr also exports downstream analyses result tables and plots. 
    Multiple cores are supported on Linux or Mac platforms.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">TSSr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette.html">TSSr Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Linlab-slu/TSSr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="tssr-an-rbioconductor-package-for-comprehensive-analyses-of-transcription-start-sit-tss-data" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tssr-an-rbioconductor-package-for-comprehensive-analyses-of-transcription-start-sit-tss-data" class="anchor"></a>TSSr: an R/Bioconductor package for comprehensive analyses of transcription start sit (TSS) data</h1></div>
<div id="zhaolian-lu-keenan-berry-zhenbin-hu-yu-zhan-tae-hyuk-ahn-zhenguo-lin" class="section level5">
<h5 class="hasAnchor">
<a href="#zhaolian-lu-keenan-berry-zhenbin-hu-yu-zhan-tae-hyuk-ahn-zhenguo-lin" class="anchor"></a>Zhaolian Lu, Keenan Berry, Zhenbin Hu, Yu Zhan, Tae-Hyuk Ahn, Zhenguo Lin</h5>
</div>
<div id="1-intruduction" class="section level2">
<h2 class="hasAnchor">
<a href="#1-intruduction" class="anchor"></a>1. Intruduction</h2>
<p>Documentation is also available on GitHub Pages: <a href="https://github.com/Linlab-slu/TSSr" class="uri">https://github.com/Linlab-slu/TSSr</a></p>
<p>TSSr is an R package that provides rich functions for mapping transcription start sites (TSSs) and characterizations of structures and activities of core promoters based on various types of sequencing data generated by high-throughput techniques that sequence the very 5’end of RNA transcripts (TSS sequencing), such as cap analysis of gene expression (CAGE),nAnT-iCAGE, NanoCAGE, transcript leader sequencing (TL-seq), transcript isoform sequencing (TIF-seq), TSS-seq, RAMPAGE, single-cell tagged reverse transcription (STRT), global nuclear run-on cap (GRO-cap) and STRIPE-seq.</p>
<p>The main fucntions of TSSr include identifications of TSSs, normalization and filtration of TSS signals, clustering of TSS to infer core promoters, quantifications of core promoter activities and shape, assigning TSS cluster to genes, gene differential expression, core promoter shift. TSSr uses multiple formats of files as input, such as Binary Sequence Alignment Mao (BAM) files (single-ended or paired-ended), Browser Extension Data (bed) files, BigWig files, or TSS tables. TSSr generates various types of TSS or core promoter track files which can be visualized in the UCSC Genome Browser or Integrative Genomics Viewer (IGV). TSSr also exports various raw and processed result tables and visualization plots. Multiple cores are supported on Linux or Mac OS platforms.</p>
</div>
<div id="2-pre-requisites" class="section level2">
<h2 class="hasAnchor">
<a href="#2-pre-requisites" class="anchor"></a>2. Pre-requisites:</h2>
<ul>
<li>
<p>R version</p>
<ul>
<li>Download R (&gt;3.4.0) version from CRAN.
<ul>
<li>Windows: <a href="https://cran.r-project.org/bin/windows/base/" class="uri">https://cran.r-project.org/bin/windows/base/</a>
</li>
<li>Mac OS X: <a href="https://cran.r-project.org/bin/macosx/" class="uri">https://cran.r-project.org/bin/macosx/</a>
</li>
<li>Linux: <a href="https://cran.r-project.org/bin/linux/" class="uri">https://cran.r-project.org/bin/linux/</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Rsamtools package</p>
<ul>
<li>
<p>install by using the following R commands:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"Rsamtools"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>GenomicRanges</p>
<ul>
<li>
<p>install by using the following R commands:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"GenomicRanges"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>GenomicFeature package</p>
<ul>
<li>
<p>install by using the following R commands:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"GenomicFeatures"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>Gviz package</p>
<ul>
<li>
<p>install by using the following R commands:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"Gviz"</span>)  </span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>rtracklayer package</p>
<ul>
<li>
<p>install by using the following R commands:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"rtracklayer"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>DESeq2 package:</p>
<ul>
<li>
<p>install by using the following R command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"DESeq2"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>BSgenome package</p>
<ul>
<li>
<p>install by using the following R command:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"BSgenome"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>data.table package</p>
<ul>
<li>
<p>install by using the following R command:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"data.table"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">install.packages</span>(<span class="st">"data.table"</span>)</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>stringr package</p>
<ul>
<li>
<p>install by using the following R command:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"stringr"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">install.packages</span>(<span class="st">"stringr"</span>)</span></code></pre></div>
</li>
</ul>
</li>
</ul>
</div>
<div id="3-installing-tssr-package" class="section level2">
<h2 class="hasAnchor">
<a href="#3-installing-tssr-package" class="anchor"></a>3. Installing TSSr Package:</h2>
<p>To install the TSSr package all the prerequisites above need to be installed. After confirming those packages are installed, you can install the development version directly from GitHub using devtools:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>    devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"Linlab-slu/TSSr"</span>)</span></code></pre></div>
</div>
<div id="4-input-data-for-tssr" class="section level2">
<h2 class="hasAnchor">
<a href="#4-input-data-for-tssr" class="anchor"></a>4. Input data for TSSr</h2>
<ul>
<li>
<p>Input data files</p>
<p>TSSr accepts two types of input data: read alignment files or TSS tables. The read alignment files in compressed binary alignment map (BAM) format are required if users intend to identify TSSs from mapped sequencing data. BAM files can be derived from mapping of either paired-end or single-end TSS sequencing reads. A TSS table is a matrix of TSS data generated by TSSr or other bioinformatics tools. A TSS table can be a tab-delimited text file, a BigWig (bw) binary type file, or browser extensible data (bed) type file. A tab-delimited TSS table contains chromosome ID, genomic coordinates, strand information, and raw or normalized read counts of each sample. An example TSS table can be downlaoded from <a href="http://zlinlab.org/TSSr/ALL.samples.TSS.raw.txt" class="uri">http://zlinlab.org/TSSr/ALL.samples.TSS.raw.txt</a>.</p>
</li>
<li>
<p>Reference genome</p>
<p>The reference genome stored as a BSgenome data package must be provided for identification of TSSs from bam files. For available BSgenome genome objects, please check (<a href="https://bioconductor.org/packages/BSgenome" class="uri">https://bioconductor.org/packages/BSgenome</a>). In case the BSgenome object of a species is unavailable in the BSgenome package (not in the list returned by BSgenome::available.genomes() function), a custom BSgenome object has to be built and installed before running this package. (See the vignette “How to forge a BSgenome data package” within the BSgenome package for instructions). A genome annotation file (GTF or GFF file) is required for assigning TSS clusters to genes or other genomic features by using the annotateCluster function of TSSr. The chromosome names in BSgenome, genome annotation file as well as the reference genome used for mapping sequencing reads must be consistent.</p>
</li>
<li>
<p>S4 object</p>
<p>TSSr uses S4 object to store all input files and arguments and generate downstream analysis results.</p>
</li>
</ul>
</div>
<div id="5-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#5-usage" class="anchor"></a>5. Usage:</h2>
<ul>
<li>
<p>Launch TSSr</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>  <span class="kw">library</span>(TSSr)</span></code></pre></div>
</li>
<li>
<p>Example TSSr object. Users may explore the structure of a TSSr object and TSSr fucntions using provided example TSSr object “exampleTSSr”. Skip this step if the user plan to generate a new TSSr object from bam or TSS table files.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>  <span class="kw">data</span>(exampleTSSr)</span>
<span id="cb12-2"><a href="#cb12-2"></a>  myTSSr &lt;-<span class="st"> </span>exampleTSSr </span></code></pre></div>
</li>
<li>
<p>Generating a new TSSr object from BAM or TSS table files. To generate a new TSSr object, several arguments of the constructer “new” function must be specified. The first step is to provide the path and file names of input files for argument “inputFiles”. Four example BAM files (S01.sorted.bam, S02.sorted.bam, S03.sorted.bam, S04.sorted.bam) can be downloaded from <a href="http://www.zlinlab.org/TSSr.html" class="uri">http://www.zlinlab.org/TSSr.html</a>. These BAM files were generated using nAnT-iCAGE from a budding yeast Saccharomyces cerevisiae (Lu and Lin 2019). The nAnT-iCAGE reads were mapped to the reference genome of S. cerevisiae (R64-2-1) using HISAT2 (Kim, Langmead et al. 2015). To reduced sample file size, each BAM file only includes sequencing reads mapped to two chromosomes (Chr I and Chr II). A TSS table genereated from the four BAM files can be downloaded from <a href="http://zlinlab.org/TSSr/ALL.samples.TSS.raw.txt" class="uri">http://zlinlab.org/TSSr/ALL.samples.TSS.raw.txt</a>, which can also be used as a input file. Assuming the bam or TSS files are saved to the current working directory:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>  inputFiles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"S01.sorted.bam"</span>, <span class="st">"S02.sorted.bam"</span>, <span class="st">"S03.sorted.bam"</span>, <span class="st">"S04.sorted.bam"</span>) <span class="co"># if use a TSS table: inputFiles &lt;- "ALL.samples.TSS.raw.txt"</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  inputFilesType &lt;-<span class="st"> "bam"</span> <span class="co"># set “inputFilesType” as “bamPairedEnd” for paired-end BAM files, and as "TSStable" if the input file is a TSS table </span></span></code></pre></div>
</li>
<li>
<p>Install and launch required BSgenome object. The corresponding BSgenome object of S. cerevisiae “BSgenome.Scerevisiae.UCSC.sacCer3” is available from BSgenome Bioconductor package (<a href="https://bioconductor.org/packages/BSgenome" class="uri">https://bioconductor.org/packages/BSgenome</a>).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">"BSgenome.Scerevisiae.UCSC.sacCer3"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb14-2"><a href="#cb14-2"></a>  BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">"BSgenome.Scerevisiae.UCSC.sacCer3"</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="kw">library</span>(BSgenome.Scerevisiae.UCSC.sacCer3) </span></code></pre></div>
</li>
<li>
<p>Provide path and file name of genome annotation file. The example genome annotation of S. cerevisiae (R64-2-1) was originally obtained from the Saccharomyces Genome Database. It ban be downlaoded from <a href="http://zlinlab.org/TSSr/saccharomyces_cerevisiae_R64-2-1.gff" class="uri">http://zlinlab.org/TSSr/saccharomyces_cerevisiae_R64-2-1.gff</a>. Assuming the gff file is saved to the current working directory:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>  refSource &lt;-<span class="st"> "saccharomyces_cerevisiae_R64-2-1.gff"</span> </span></code></pre></div>
</li>
<li>
<p>Creating a new TSSr object using the constructer “new” function. In addition to the input data file “inputFiles” and file type “inputFilesType”, BSgenome object name, and genome annotaion file “refSource”, several other arguments need to be specified, including “sampleLabels”, “sampleLabelsMerged”, and “mergeIndex” and “organismName”. In the example data, sample lables “SL01, SL02, SL03 and SL04” were used for “S01.sorted.bam, S02.sorted.bam, S03.sorted.bam, S04.sorted.bam”, respectively (sampleLabels = c(“SL01”,“SL02”,“SL03”,“SL04”)). If a TSS table is used as input data, the sample lable of each sample is its column name in the TSS table. “sampleLabelsMerged” will be used if the user need to merge TSS signals from multiple samples (e.g., biological replicates) into a single dataset. In this case, SL01 and SL02 are two biological replicates obtained from S. cerevisiae cells grown in rich medium (“control”), while SL03 and SL04 were obtained by treating S. cerevisiae with α factor (“treat”). Thus, sampleLabelsMerged = c(“control”,“treat”) and mergeIndex = c(1,1,2,2), which means SL01 and SL02 will be merged as group 1 “control”, and SL03 and SL04 will be merged as group 2 “treat”. “organismName” is the species name of the samples, which will be used to annotate TSS clusters by “annotateCluster”.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>  myTSSr &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"TSSr"</span>, <span class="dt">genomeName =</span> <span class="st">"BSgenome.Scerevisiae.UCSC.sacCer3"</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>            ,<span class="dt">inputFiles =</span> inputFiles</span>
<span id="cb16-3"><a href="#cb16-3"></a>            ,<span class="dt">inputFilesType =</span> inputFilesType</span>
<span id="cb16-4"><a href="#cb16-4"></a>            ,<span class="dt">sampleLabels =</span> <span class="kw">c</span>(<span class="st">"SL01"</span>,<span class="st">"SL02"</span>,<span class="st">"SL03"</span>,<span class="st">"SL04"</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>            ,<span class="dt">sampleLabelsMerged =</span> <span class="kw">c</span>(<span class="st">"control"</span>,<span class="st">"treat"</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a>            ,<span class="dt">mergeIndex =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a>            ,<span class="dt">refSource =</span> refSource</span>
<span id="cb16-8"><a href="#cb16-8"></a>            ,<span class="dt">organismName =</span> <span class="st">"saccharomyces cerevisiae"</span>)</span></code></pre></div>
<p>To display the available slots in the created TSSr object by typing the TSSr object name. Most slots in the newly created TSSr object are empty at this point since no analysis has been conducted.:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>   myTSSr</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="co"># An object of class "TSSr"</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="co"># Slot "genomeName":</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="co"># [1] "BSgenome.Scerevisiae.UCSC.sacCer3"</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="co"># </span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="co"># Slot "inputFiles":</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="co"># [1] "S01.sorted.bam" "S02.sorted.bam" "S03.sorted.bam" "S04.sorted.bam"</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="co"># </span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="co"># Slot "inputFilesType":</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="co"># [1] "bam"</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="co"># </span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="co"># Slot "sampleLabels":</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="co"># [1] "SL01" "SL02" "SL03" "SL04"</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>  <span class="co"># </span></span>
<span id="cb17-16"><a href="#cb17-16"></a>  <span class="co"># Slot "sampleLabelsMerged":</span></span>
<span id="cb17-17"><a href="#cb17-17"></a>  <span class="co"># [1] "control" "treat"  </span></span>
<span id="cb17-18"><a href="#cb17-18"></a>  <span class="co"># </span></span>
<span id="cb17-19"><a href="#cb17-19"></a>  <span class="co"># Slot "librarySizes":</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>  <span class="co"># numeric(0)</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>  <span class="co"># </span></span>
<span id="cb17-22"><a href="#cb17-22"></a>  <span class="co"># Slot "TSSrawMatrix":</span></span>
<span id="cb17-23"><a href="#cb17-23"></a>  <span class="co"># data frame with 0 columns and 0 rows</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>  <span class="co"># </span></span>
<span id="cb17-25"><a href="#cb17-25"></a>  <span class="co"># Slot "mergeIndex":</span></span>
<span id="cb17-26"><a href="#cb17-26"></a>  <span class="co"># [1] 1 1 2 2</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>  <span class="co"># </span></span>
<span id="cb17-28"><a href="#cb17-28"></a>  <span class="co"># Slot "TSSprocessedMatrix":</span></span>
<span id="cb17-29"><a href="#cb17-29"></a>  <span class="co"># data frame with 0 columns and 0 rows</span></span>
<span id="cb17-30"><a href="#cb17-30"></a>  <span class="co"># </span></span>
<span id="cb17-31"><a href="#cb17-31"></a>  <span class="co"># Slot "tagClusters":</span></span>
<span id="cb17-32"><a href="#cb17-32"></a>  <span class="co"># list()</span></span>
<span id="cb17-33"><a href="#cb17-33"></a>  <span class="co"># </span></span>
<span id="cb17-34"><a href="#cb17-34"></a>  <span class="co"># Slot "consensusClusters":</span></span>
<span id="cb17-35"><a href="#cb17-35"></a>  <span class="co"># list()</span></span>
<span id="cb17-36"><a href="#cb17-36"></a>  <span class="co"># </span></span>
<span id="cb17-37"><a href="#cb17-37"></a>  <span class="co"># Slot "clusterShape":</span></span>
<span id="cb17-38"><a href="#cb17-38"></a>  <span class="co"># list()</span></span>
<span id="cb17-39"><a href="#cb17-39"></a>  <span class="co"># </span></span>
<span id="cb17-40"><a href="#cb17-40"></a>  <span class="co"># Slot "refSource":</span></span>
<span id="cb17-41"><a href="#cb17-41"></a>  <span class="co"># [1] "saccharomyces_cerevisiae_R64-2-1.gff"</span></span>
<span id="cb17-42"><a href="#cb17-42"></a>  <span class="co"># </span></span>
<span id="cb17-43"><a href="#cb17-43"></a>  <span class="co"># Slot "refTable":</span></span>
<span id="cb17-44"><a href="#cb17-44"></a>  <span class="co"># data frame with 0 columns and 0 rows</span></span>
<span id="cb17-45"><a href="#cb17-45"></a>  <span class="co"># </span></span>
<span id="cb17-46"><a href="#cb17-46"></a>  <span class="co"># Slot "organismName":</span></span>
<span id="cb17-47"><a href="#cb17-47"></a>  <span class="co"># [1] "Saccharomyces cerevisiae"</span></span>
<span id="cb17-48"><a href="#cb17-48"></a>  <span class="co"># </span></span>
<span id="cb17-49"><a href="#cb17-49"></a>  <span class="co"># Slot "assignedClusters":</span></span>
<span id="cb17-50"><a href="#cb17-50"></a>  <span class="co"># list()</span></span>
<span id="cb17-51"><a href="#cb17-51"></a>  <span class="co"># </span></span>
<span id="cb17-52"><a href="#cb17-52"></a>  <span class="co"># Slot "unassignedClusters":</span></span>
<span id="cb17-53"><a href="#cb17-53"></a>  <span class="co"># list()</span></span>
<span id="cb17-54"><a href="#cb17-54"></a>  <span class="co"># </span></span>
<span id="cb17-55"><a href="#cb17-55"></a>  <span class="co"># Slot "filteredClusters":</span></span>
<span id="cb17-56"><a href="#cb17-56"></a>  <span class="co"># list()</span></span>
<span id="cb17-57"><a href="#cb17-57"></a>  <span class="co"># </span></span>
<span id="cb17-58"><a href="#cb17-58"></a>  <span class="co"># Slot "DEtables":</span></span>
<span id="cb17-59"><a href="#cb17-59"></a>  <span class="co"># list()</span></span>
<span id="cb17-60"><a href="#cb17-60"></a>  <span class="co"># </span></span>
<span id="cb17-61"><a href="#cb17-61"></a>  <span class="co"># Slot "TAGtables":</span></span>
<span id="cb17-62"><a href="#cb17-62"></a>  <span class="co"># list()</span></span>
<span id="cb17-63"><a href="#cb17-63"></a>  <span class="co"># </span></span>
<span id="cb17-64"><a href="#cb17-64"></a>  <span class="co"># Slot "PromoterShift":</span></span>
<span id="cb17-65"><a href="#cb17-65"></a>  <span class="co"># list()</span></span></code></pre></div>
</li>
<li>
<p>TSS calling from bam files or retrieving TSS data from TSS table using “getTSS” function. The “getTSS” function identifies genomic coordinates of all TSSs and calculates read counts supporting each TSS from bam file and return values to the slot of TSSrawMatrix. Before TSS calling, TSSr removes reads that are below certain sequencing quality and mapping quality. The default threshold for Phred quality score is 10, and mapping quality (MAPQ score) is 20. Users may change these arguments by setting different values for “sequencingQualityThreshold” and “mappingQualityThreshold” when running the “getTSS” function. If a mapped TSS sequencing read starts with a G that is a mismatch to the reference genome, the uncoded 5’ end G is likely the m7G cap, and thus the uncoded G will be removed from TSS calling by “getTSS”. If a matched G at the 5’end of a tag is considered as an added cap, TSSr treats the 5’end of reads with matched G as genome-coded G, and the first G is not removed when calling TSS. This strategy is based on a stronge preference of PyPu dinucleotide at the [-1, +1] sites. This strategy also makes TSSr suitable for calling TSSs from 5’end sequencing reads that are not based on cap capture techniques.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>  <span class="kw">getTSS</span>(myTSSr)</span></code></pre></div>
<p>TSS calling from bam files or retrieving TSS data from TSS table</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>  myTSSr<span class="op">@</span>TSSrawMatrix</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="co">#           chr    pos strand SL01 SL02 SL03 SL04</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="co">#      1:  chrI   1561      +    0    0    0    1</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="co">#      2:  chrI   5759      +    1    0    0    0</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="co">#      3:  chrI   5765      +    1    0    0    0</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="co">#      4:  chrI   5773      +    1    0    0    0</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="co">#      5:  chrI   5925      +    0    1    0    0</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="co">#     ---                                        </span></span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="co"># 163208: chrII 810860      -    0    0    0    2</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="co"># 163209: chrII 810963      -    0    1    0    0</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>  <span class="co"># 163210: chrII 811112      -    0    0    1    0</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>  <span class="co"># 163211: chrII 811370      -    1    0    0    0</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>  <span class="co"># 163212: chrII 812101      -    1    0    0    0</span></span></code></pre></div>
</li>
<li>
<p>TSSrawMatrix contains genomic coordinates and read counts of each called TSS. TSSrawMatrix can be exported by “exportTSStable” function to a TSS table “ALL.samples.TSS.raw.txt” in the working directory. The TSS table can be used as input file for future downstram analyses using TSSr or other tools. It is advised to export unmerged TSSrawMatrix to an TSS table to avoid repeated TSS calling step.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>  <span class="kw">exportTSStable</span>(myTSSr, <span class="dt">data =</span> <span class="st">"raw"</span>, <span class="dt">merged =</span> <span class="st">"FALSE"</span>)</span></code></pre></div>
</li>
<li>
<p>The “plotCorrelation” function is used to calculate the pairwise correlation coefficients and plot pairwise scatter plots of TSS counts. A subset of samples can also be specified to display the pairwise correlations. Three correlation methods are supported: “pearson”, “kendall”, or “spearman”. The default setting generates scatter plots for all samples (samples = “all”). For plotting a subset of samples, users may provide a list of sample labels for “sample”, e.g., samples = c(“SL01”,“SL02”,“SL03”).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>  <span class="kw">plotCorrelation</span>(myTSSr, <span class="dt">samples =</span> <span class="st">"all"</span>)</span></code></pre></div>
</li>
</ul>
<p><img src="https://github.com/Linlab-slu/TSSr/raw/master/vignettes/figures/01_TSS_correlation_plot_of_all_samples_v2.png" alt="01_TSS_correlation_plot_of_all_samples"></p>
<ul>
<li>
<p>TSS includes “plotPCA” function to plot results principle component analysis (PCA) of all samples to obtain an overview of the TSS data in a low-dimensional subspace and for quality assessment. plotPCA will make a biplot which visualizes both how samples relate to each other in terms of the first principal component (PC1) and the second principal component (PC2) and simultaneously show how each variable contributes to each principal component.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a> <span class="kw">plotTssPCA</span>(myTSSr, <span class="dt">TSS.threshold=</span><span class="dv">10</span>)</span></code></pre></div>
</li>
</ul>
<p><img src="https://github.com/Linlab-slu/TSSr/raw/master/vignettes/figures/02_PCA_plot_v2.png" alt="02_PCA_plot"></p>
<ul>
<li>
<p>Merging samples (biological replicates). Users can merge multiple samples (e.g., biological replicates) into previously defined groups with mergeSamples function. The “mergeIndex” argument directs which samples will be merged and how the final dataset will be ordered accordingly. The merged read counts and genomic coordinates are stored in the TSSprocessedMatrix slot.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>  <span class="kw">mergeSamples</span>(myTSSr)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>  myTSSr<span class="op">@</span>TSSprocessedMatrix</span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="co">#           chr    pos strand control treat</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="co">#      1:  chrI   1561      +       0     1</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="co">#      2:  chrI   5759      +       1     0</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="co">#      3:  chrI   5765      +       1     0</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="co">#      4:  chrI   5773      +       1     0</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="co">#      5:  chrI   5925      +       1     0</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="co">#     ---                                  </span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="co"># 163208: chrII 810860      -       0     2</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="co"># 163209: chrII 810963      -       1     0</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="co"># 163210: chrII 811112      -       0     1</span></span>
<span id="cb23-15"><a href="#cb23-15"></a>  <span class="co"># 163211: chrII 811370      -       1     0</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="co"># 163212: chrII 812101      -       1     0</span></span></code></pre></div>
<p>To return library sizes (number of total read counts) of merged samples in TSSr object in the specified order (note: order is specified in mergeSample function):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>  myTSSr<span class="op">@</span>librarySizes</span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="co"># control   treat </span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="co"># 3221609 5131202</span></span></code></pre></div>
<p>Library sizes among different samples are different. To provide between-sample comparability, the raw read counts of each TSS need to be scaled as tags per million mapped reads (TPM) with normalizeTSS function.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>  <span class="kw">normalizeTSS</span>(myTSSr)</span></code></pre></div>
<p>Users may use the “filterTSS” option to remove TSSs with low support from mapped reads based on TMP value or p-value inferred by “Poisson distribution”. For “TPM” filtering (method = “TPM”), any TSS that has a lower TPM value than user-defined threshold “tpmLow” will be removed (default TPM threshold = 0.1). For “poisson” method (method = “poisson”), TSSr calculates the probability of observing k numbers of reads supporting each TSS based on the sequencing depth of the sample per the Poisson distribution. Only TSSs with a significantly larger number of supporting reads than expected (default threshold p &lt; 0.01) are considered as qualified TSSs. Non-significant TSSs are thus filtered by TSSr.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>  <span class="kw">filterTSS</span>(myTSSr, <span class="dt">method =</span> <span class="st">"poisson"</span>)   </span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a>  myTSSr<span class="op">@</span>TSSprocessedMatrix</span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="co">#           chr    pos strand  control    treat</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="co">#      1:  chrI   1561      + 0.000000 0.194886</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="co">#      2:  chrI   5759      + 0.310404 0.000000</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="co">#      3:  chrI   5765      + 0.310404 0.000000</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="co">#      4:  chrI   5773      + 0.310404 0.000000</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="co">#      5:  chrI   5925      + 0.310404 0.000000</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="co">#     ---                                      </span></span>
<span id="cb26-12"><a href="#cb26-12"></a>  <span class="co"># 163208: chrII 810860      - 0.000000 0.389772</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="co"># 163209: chrII 810963      - 0.310404 0.000000</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="co"># 163210: chrII 811112      - 0.000000 0.194886</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="co"># 163211: chrII 811370      - 0.310404 0.000000</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="co"># 163212: chrII 812101      - 0.310404 0.000000</span></span></code></pre></div>
<p>Simialr to the raw read counts, the normalized and filtered (processed) TSS matrix can be exported to delimited text file with “exportTSStable” function or bedGraph/BigWig files with “exportTSStoBedgraph” fucntion. bedGraph/BigWig files can be visualized in the UCSC Genome Browser or Integrative Genomics Viewer (IGV) or Genome Browser at YeasTSS.org for selected yeast species.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>  <span class="kw">exportTSStable</span>(myTSSr, <span class="dt">data =</span> <span class="st">"processed"</span>) </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="kw">exportTSStoBedgraph</span>(myTSSr, <span class="dt">data =</span> <span class="st">"processed"</span>, <span class="dt">format =</span> <span class="st">"bedGraph"</span>) </span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="kw">exportTSStoBedgraph</span>(myTSSr, <span class="dt">data =</span> <span class="st">"processed"</span>, <span class="dt">format =</span> <span class="st">"BigWig"</span>)</span></code></pre></div>
</li>
<li>
<p>Clustering TSSs to infer core promoters with “clusterTSS” function.</p>
<p>The “clusterTSS” function was designed to group neighboring TSSs into distinct TSS clusters (TCs), representing putative core promoters. It implements a TSS clustering algorithm based on peaking identification, namely “peakclu” (peak clustering) (Lu and Lin, 2021). Briefly, peakclu applies a sliding window approach (default window size = 100 bp with step size = 1) to scan TSS signals from the 5′ end of both strands of each chromosome. In each window, the TSS with the highest TPM value was identified as the peak. The surrounding TSSs are grouped with the peak into a TC. The clustering process of a TC terminates if a TSS is ≥ n bp (default n = 25) away from the nearest upstream TSS. In addition to setting a minimal allowed distance between peaks, TSSr offers another option to set maximal allowed extension distance between neighboring TSSs around peaks, which enables users to define the boundaries between neighboring core promoters. clusterTSS calculates inter-quantile width of a core promoter based on the cumulative distribution of TSS signals within the promoter. The positions of the 10th to 90th quantiles of TSS signals, which include at least 80% transcription initiation signals within a cluster, were defined as the 5’ and 3’ boundaries of the core promoter. The clustering step might be slow especially when the number of TSSs is in millions. Using multicores is highly recommended.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>  <span class="kw">clusterTSS</span>(myTSSr, <span class="dt">method =</span> <span class="st">"peakclu"</span>,<span class="dt">peakDistance=</span><span class="dv">100</span>,<span class="dt">extensionDistance=</span><span class="dv">30</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>         ,<span class="dt">localThreshold =</span> <span class="fl">0.02</span>,<span class="dt">clusterThreshold =</span> <span class="dv">1</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>         ,<span class="dt">useMultiCore=</span><span class="ot">FALSE</span>, <span class="dt">numCores=</span><span class="ot">NULL</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>  myTSSr<span class="op">@</span>tagClusters</span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="co"># $control</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="co">#       cluster   chr  start    end strand dominant_tss       tags tags.dominant_tss  q_0.1  q_0.9 interquantile_width</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>  <span class="co">#    1:       1  chrI   6530   6564      +         6548   9.312118          3.724847   6530   6562                  33</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>  <span class="co">#    2:       2  chrI   7166   7189      +         7169   1.241616          0.620808   7166   7189                  24</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>  <span class="co">#    3:       3  chrI   8084   8087      +         8084   1.241616          0.620808   8084   8087                   4</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>  <span class="co">#    4:       4  chrI   9325   9411      +         9327   4.966464          1.241616   9327   9391                  65</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>  <span class="co">#    5:       5  chrI   9442   9479      +         9442   3.414443          1.862423   9442   9468                  27</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>  <span class="co">#   ---                                                                                                               </span></span>
<span id="cb28-15"><a href="#cb28-15"></a>  <span class="co"># 3300:    3300 chrII 804855 804975      -       804895 260.739280         71.703301 804868 804899                  32</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>  <span class="co"># 3301:    3301 chrII 807129 807179      -       807165  16.761812          6.518482 807161 807168                   8</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>  <span class="co"># 3302:    3302 chrII 808679 808723      -       808723   1.862424          0.931212 808679 808723                  45</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>  <span class="co"># 3303:    3303 chrII 809353 809377      -       809377   1.862424          1.552020 809353 809377                  25</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="co"># 3304:    3304 chrII 809707 809748      -       809707   4.035251          2.172827 809707 809724                  18</span></span>
<span id="cb28-20"><a href="#cb28-20"></a></span>
<span id="cb28-21"><a href="#cb28-21"></a>  <span class="co"># $treat</span></span>
<span id="cb28-22"><a href="#cb28-22"></a>  <span class="co">#      cluster   chr  start    end strand dominant_tss       tags tags.dominant_tss  q_0.1  q_0.9 interquantile_width</span></span>
<span id="cb28-23"><a href="#cb28-23"></a>  <span class="co">#   1:       1  chrI   6521   6564      +         6559   5.067037          1.753975   6530   6559                  30</span></span>
<span id="cb28-24"><a href="#cb28-24"></a>  <span class="co">#   2:       2  chrI   7096   7118      +         7100   1.948860          0.584658   7096   7114                  19</span></span>
<span id="cb28-25"><a href="#cb28-25"></a>  <span class="co">#   3:       3  chrI   8061   8087      +         8061   1.948860          0.584658   8061   8087                  27</span></span>
<span id="cb28-26"><a href="#cb28-26"></a>  <span class="co">#   4:       4  chrI   9327   9476      +         9359  11.498278          1.753975   9327   9452                 126</span></span>
<span id="cb28-27"><a href="#cb28-27"></a>  <span class="co">#   5:       5  chrI  11259  11343      +        11329  59.245376         21.827244  11288  11329                  42</span></span>
<span id="cb28-28"><a href="#cb28-28"></a>  <span class="co">#  ---                                                                                                               </span></span>
<span id="cb28-29"><a href="#cb28-29"></a>  <span class="co"># 3244:    3244 chrII 804855 804952      -       804895 155.908888         54.568111 804872 804901                  30</span></span>
<span id="cb28-30"><a href="#cb28-30"></a>  <span class="co"># 3245:    3245 chrII 807118 807179      -       807165  13.642026          5.456811 807153 807165                  13</span></span>
<span id="cb28-31"><a href="#cb28-31"></a>  <span class="co"># 3246:    3246 chrII 808655 808691      -       808679   1.753974          0.779544 808655 808691                  37</span></span>
<span id="cb28-32"><a href="#cb28-32"></a>  <span class="co"># 3247:    3247 chrII 809377 809389      -       809377   1.169316          0.779544 809377 809389                  13</span></span>
<span id="cb28-33"><a href="#cb28-33"></a>  <span class="co"># 3248:    3248 chrII 809707 809710      -       809707   1.364203          0.974431 809707 809710                   4</span></span></code></pre></div>
<p>The results of TSS clustering can be exported to delimited text file with “exportClustersTable” function or bedGraph files with “exportClustersToBed” fucntion.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>  <span class="kw">exportClustersTable</span>(myTSSr, <span class="dt">data =</span> <span class="st">"tagClusters"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="kw">exportClustersToBed</span>(myTSSr, <span class="dt">data =</span> <span class="st">"tagClusters"</span>) </span></code></pre></div>
</li>
<li>
<p>Aggregating consensus TSS clusters</p>
<p>TSSr infers a set of consensus core promoters using the “consensusCluster” function to assign the same ID for TCs belong to the same core promoter, which allows subsequent comparative studies across samples. TCs from different samples are considered to belong to the same consensus core promoter if the distance of their dominant TSSs is smaller than a user-defined distance (default = 50 bp). Similarly to clusterTSS function, consensusCluster function also returns genomic coordinates, sum of TSS tags, dominate TSS coordinate, a lower (q0.1) and an upper (q0.9) quantile coordinates, and interquantile widths for each consensus cluster in each sample.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>  <span class="kw">consensusCluster</span>(myTSSr, <span class="dt">dis =</span> <span class="dv">50</span>, <span class="dt">useMultiCore =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Similarly, the detailed information of consensus clusters can be exported to delimited text files with “exportClustersTable” function or bedGraph files with “exportClustersToBed” fucntion.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>  <span class="kw">exportClustersTable</span>(myTSSr, <span class="dt">data =</span> <span class="st">"consensusClusters"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="kw">exportClustersToBed</span>(myTSSr, <span class="dt">data =</span> <span class="st">"consensusClusters"</span>) </span></code></pre></div>
</li>
<li>
<p>Quantification of core promoter shape</p>
<p>Core promoter shape reflects the distribution of TSS signals within a core promoter. TSSr provides three different options, inter-quantile width, promoter shape score (PSS) and shape index (SI), to quantify core promoter shape. Inter-quantile width refers to the distance between the locations of the 10th percentile to the 90th percentile TSS signals within a TSS cluster. Thus, it measures the width of a core promoter, but lacks the information of distribution patterns of TSS signals within a core promoter. Inter-quantile width could be significantly affected by different clustering methods. plotInterQuantile function plots interquantile width of each sample.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>  <span class="kw">plotInterQuantile</span>(myTSSr,<span class="dt">samples =</span> <span class="st">"all"</span>,<span class="dt">tagsThreshold =</span> <span class="dv">1</span>)</span></code></pre></div>
</li>
</ul>
<p><img src="https://github.com/Linlab-slu/TSSr/raw/master/vignettes/figures/03_Interquantile_plot_of_ALL_samples_v2.png" alt="03_Interquantile_plot_of_ALL_samples"></p>
<p>Promoter shape score (PSS) integrates both inter quantile width and the observed probabilities of tags at every TSSs within a cluster (Lu and Lin 2019). PSS can be calculated using using shapeCluster function with method set as “PSS”. The smaller value represents the sharper core promoter. PSS is 0 representing singletons. SI is determined by the probabilities of tags at every TSSs within one cluster (Hoskins, Landolin et al. 2011). SI is also calculated using shapeCluster function with method set as “SI”. The greater value represents the sharper core promoter. The SI = 2 represents singletons.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>    <span class="kw">shapeCluster</span>(myTSSr,<span class="dt">clusters =</span> <span class="st">"consensusClusters"</span>, <span class="dt">method =</span> <span class="st">"PSS"</span>,<span class="dt">useMultiCore=</span> <span class="ot">FALSE</span>, <span class="dt">numCores =</span> <span class="ot">NULL</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a></span>
<span id="cb33-3"><a href="#cb33-3"></a>    myTSSr<span class="op">@</span>clusterShape</span>
<span id="cb33-4"><a href="#cb33-4"></a>    </span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="co"># $control</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="co">#       cluster   chr  start    end strand dominant_tss       tags tags.dominant_tss  q_0.1  q_0.9 interquantile_width shape.score</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="co">#    1:       1  chrI   6530   6564      +         6548   9.312118          3.724847   6530   6562                  33    9.646916</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>    <span class="co">#    2:       3  chrI   7166   7189      +         7169   1.241616          0.620808   7166   7189                  24    6.877444</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="co">#    3:       4  chrI   8084   8087      +         8084   1.241616          0.620808   8084   8087                   4    2.000000</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>    <span class="co">#    4:       5  chrI   9325   9411      +         9327   4.966464          1.241616   9327   9391                  65   17.767262</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>    <span class="co">#    5:       6  chrI   9442   9479      +         9442   3.414443          1.862423   9442   9468                  27    7.469695</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="co">#   ---                                                                                                                           </span></span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="co"># 3299:    4286 chrII 804855 804975      -       804895 260.739280         71.703301 804868 804899                  32   14.764972</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>    <span class="co"># 3300:    4287 chrII 807129 807179      -       807165  16.761812          6.518482 807161 807168                   8    5.251317</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>    <span class="co"># 3301:    4288 chrII 808679 808723      -       808723   1.862424          0.931212 808679 808723                  45    9.844044</span></span>
<span id="cb33-16"><a href="#cb33-16"></a>    <span class="co"># 3302:    4289 chrII 809353 809377      -       809377   1.862424          1.552020 809353 809377                  25    3.018611</span></span>
<span id="cb33-17"><a href="#cb33-17"></a>    <span class="co"># 3303:    4290 chrII 809707 809748      -       809707   4.035251          2.172827 809707 809724                  18    7.425270</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>    <span class="co"># </span></span>
<span id="cb33-19"><a href="#cb33-19"></a>    <span class="co"># $treat</span></span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="co">#       cluster   chr  start    end strand dominant_tss       tags tags.dominant_tss  q_0.1  q_0.9 interquantile_width shape.score</span></span>
<span id="cb33-21"><a href="#cb33-21"></a>    <span class="co">#    1:       1  chrI   6521   6564      +         6559   5.067037          1.753975   6530   6559                  30   13.123285</span></span>
<span id="cb33-22"><a href="#cb33-22"></a>    <span class="co">#    2:       2  chrI   7096   7118      +         7100   1.948860          0.584658   7096   7114                  19    9.333375</span></span>
<span id="cb33-23"><a href="#cb33-23"></a>    <span class="co">#    3:       4  chrI   8061   8087      +         8061   1.948860          0.584658   8061   8087                  27    9.012708</span></span>
<span id="cb33-24"><a href="#cb33-24"></a>    <span class="co">#    4:       5  chrI   9327   9476      +         9359  11.498278          1.753975   9327   9452                 126   25.664108</span></span>
<span id="cb33-25"><a href="#cb33-25"></a>    <span class="co">#    5:       7  chrI  11259  11343      +        11329  59.245376         21.827244  11288  11329                  42   15.020408</span></span>
<span id="cb33-26"><a href="#cb33-26"></a>    <span class="co">#   ---                                                                                                                           </span></span>
<span id="cb33-27"><a href="#cb33-27"></a>    <span class="co"># 3240:    4286 chrII 804855 804952      -       804895 155.908888         54.568111 804872 804901                  30   13.439327</span></span>
<span id="cb33-28"><a href="#cb33-28"></a>    <span class="co"># 3241:    4287 chrII 807118 807179      -       807165  13.642026          5.456811 807153 807165                  13    7.308196</span></span>
<span id="cb33-29"><a href="#cb33-29"></a>    <span class="co"># 3242:    4288 chrII 808655 808691      -       808679   1.753974          0.779544 808655 808691                  37   10.725295</span></span>
<span id="cb33-30"><a href="#cb33-30"></a>    <span class="co"># 3243:    4289 chrII 809377 809389      -       809377   1.169316          0.779544 809377 809389                  13    3.398098</span></span>
<span id="cb33-31"><a href="#cb33-31"></a>    <span class="co"># 3244:    4290 chrII 809707 809710      -       809707   1.364203          0.974431 809707 809710                   4    1.726241</span></span></code></pre></div>
<p>The distributions of core promoter shape (PSS or SI) can be illustrated by a histograms with plotShape function. Please be noted that there is only one shapeCluster slot, so either PSS or SI can be saved in the shapeCluster slot depending on which method argument was used for shapeCluster.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>    <span class="kw">plotShape</span>(myTSSr)</span></code></pre></div>
<p><img src="https://github.com/Linlab-slu/TSSr/raw/master/vignettes/figures/04_Shape_plot_of_ALL_samples_v2.png" alt="04_Shape_plot_of_ALL_samples"></p>
<p>The complete list of PSS can be exported to delimited text file with “exportShapeTable” function.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">exportShapeTable</span>(myTSSr)</span></code></pre></div>
<ul>
<li>
<p>Annotation (Assigning TCs to genes)</p>
<p>Assigning TCs to downstream genes as their core promoters is required for annotation of the 5’ boundaries of genomic features. This process is also a prerequisite for further interrogations of regulated transcription initiation at the gene level. TSSr offers the “annotateCluster” function to assign TCs to their downstream genes. The assignment of a TC to a gene is based on the distance between the position of the dominant TSS of a TC and the annotated 5’ends of coding sequences (CDS) or transcripts. The default maximum distance between the dominant TSS and CDS is 1000 bp (“upstream = 1000”). If a TC overlaps with the CDS of an upstream gene, the dominant TSS of the TC must be within 500 bp to the 3’end of the overlapping CDS by default (“upstreamOverlap = 500”) to be eligible to assign to its downstream gene. If the 5’ends of annotated transcripts, instead of CDS, are used for TC assignment, users should set “annotationType” as “transcript,” and the default distance parameter is 500 bp. Because the genomes size and the number of introns vary substantially among organisms, it is necessary to apply customized criteria for TC assignment for different organisms. Users are advised to adjust the assignment criteria for core promoter assignment in TSSr. By default, only TCs with ≥ 0.02 TPM are used for the annotation process. To reduce transcriptional or technical noise of small clusters downstream a strong cluster, the filterCluster argument was set as “filterClusterThreshold = 0.02”, indicating that any TC with TPM value &lt; 0.02 TPM will be excluded from assigning to genes.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>  <span class="kw">annotateCluster</span>(myTSSr,<span class="dt">clusters =</span> <span class="st">"consensusClusters"</span>,<span class="dt">filterCluster =</span> <span class="ot">TRUE</span>,</span>
<span id="cb36-2"><a href="#cb36-2"></a>              <span class="dt">filterClusterThreshold =</span> <span class="fl">0.02</span>, <span class="dt">annotationType =</span> <span class="st">"genes"</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>              ,<span class="dt">upstream=</span><span class="dv">1000</span>, <span class="dt">upstreamOverlap =</span> <span class="dv">500</span>, <span class="dt">downstream =</span> <span class="dv">0</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a>  myTSSr<span class="op">@</span>assignedClusters</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="co"># $control</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="co">#      cluster   chr  start    end strand dominant_tss       tags tags.dominant_tss  q_0.1  q_0.9 interquantile_width      gene inCoding</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>  <span class="co">#   1:       5  chrI   9325   9411      +         9327   4.966464          1.241616   9327   9391                  65   YAL066W     &lt;NA&gt;</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>  <span class="co">#   2:       6  chrI   9442   9479      +         9442   3.414443          1.862423   9442   9468                  27   YAL066W     &lt;NA&gt;</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>  <span class="co">#   3:       7  chrI  11253  11343      +        11329  40.662913         17.693022  11275  11329                  55 YAL064W-B     &lt;NA&gt;</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>  <span class="co">#   4:      33  chrI  31026  31151      +        31108  48.112608         17.072215  31108  31145                  38   YAL062W     &lt;NA&gt;</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="co">#   5:      34  chrI  31187  31263      +        31242 320.026426        122.609541  31212  31242                  31   YAL062W     &lt;NA&gt;</span></span>
<span id="cb36-14"><a href="#cb36-14"></a>  <span class="co">#  ---                                                                                                                                  </span></span>
<span id="cb36-15"><a href="#cb36-15"></a>  <span class="co"># 853:    4280 chrII 801003 801075      -       801023  11.174543          4.656059 801018 801061                  44 YBR296C-A     &lt;NA&gt;</span></span>
<span id="cb36-16"><a href="#cb36-16"></a>  <span class="co"># 854:    4285 chrII 804563 804593      -       804592   1.552020          0.931212 804563 804593                  31   YBR298C     &lt;NA&gt;</span></span>
<span id="cb36-17"><a href="#cb36-17"></a>  <span class="co"># 855:    4286 chrII 804855 804975      -       804895 260.739280         71.703301 804868 804899                  32   YBR298C     &lt;NA&gt;</span></span>
<span id="cb36-18"><a href="#cb36-18"></a>  <span class="co"># 856:    4289 chrII 809353 809377      -       809377   1.862424          1.552020 809353 809377                  25   YBR300C     &lt;NA&gt;</span></span>
<span id="cb36-19"><a href="#cb36-19"></a>  <span class="co"># 857:    4290 chrII 809707 809748      -       809707   4.035251          2.172827 809707 809724                  18   YBR300C     &lt;NA&gt;</span></span>
<span id="cb36-20"><a href="#cb36-20"></a>  <span class="co"># </span></span>
<span id="cb36-21"><a href="#cb36-21"></a>  <span class="co"># $treat</span></span>
<span id="cb36-22"><a href="#cb36-22"></a>  <span class="co">#      cluster   chr  start    end strand dominant_tss       tags tags.dominant_tss  q_0.1  q_0.9 interquantile_width      gene inCoding</span></span>
<span id="cb36-23"><a href="#cb36-23"></a>  <span class="co">#   1:       5  chrI   9327   9476      +         9359  11.498278          1.753975   9327   9452                 126   YAL066W     &lt;NA&gt;</span></span>
<span id="cb36-24"><a href="#cb36-24"></a>  <span class="co">#   2:       7  chrI  11259  11343      +        11329  59.245376         21.827244  11288  11329                  42 YAL064W-B     &lt;NA&gt;</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>  <span class="co">#   3:       8  chrI  11907  11934      +        11919   2.338633          0.974431  11916  11922                   7 YAL064W-B     &lt;NA&gt;</span></span>
<span id="cb36-26"><a href="#cb36-26"></a>  <span class="co">#   4:      19  chrI  21237  21248      +        21246   1.948861          1.169317  21240  21246                   7   YAL064W     &lt;NA&gt;</span></span>
<span id="cb36-27"><a href="#cb36-27"></a>  <span class="co">#   5:      34  chrI  31087  31263      +        31242 117.711208         34.299955  31119  31242                 124   YAL062W     &lt;NA&gt;</span></span>
<span id="cb36-28"><a href="#cb36-28"></a>  <span class="co">#  ---                                                                                                                                  </span></span>
<span id="cb36-29"><a href="#cb36-29"></a>  <span class="co"># 810:    4272 chrII 799105 799126      -       799126   1.169316          0.584658 799105 799126                  22   YBR296C     &lt;NA&gt;</span></span>
<span id="cb36-30"><a href="#cb36-30"></a>  <span class="co"># 811:    4280 chrII 801017 801061      -       801023   6.821011          2.338633 801023 801058                  36 YBR296C-A     &lt;NA&gt;</span></span>
<span id="cb36-31"><a href="#cb36-31"></a>  <span class="co"># 812:    4286 chrII 804855 804952      -       804895 155.908888         54.568111 804872 804901                  30   YBR298C     &lt;NA&gt;</span></span>
<span id="cb36-32"><a href="#cb36-32"></a>  <span class="co"># 813:    4289 chrII 809377 809389      -       809377   1.169316          0.779544 809377 809389                  13   YBR300C     &lt;NA&gt;</span></span>
<span id="cb36-33"><a href="#cb36-33"></a>  <span class="co"># 814:    4290 chrII 809707 809710      -       809707   1.364203          0.974431 809707 809710                   4   YBR300C     &lt;NA&gt;</span></span></code></pre></div>
<p>Instead of visualizing TSSs and core promoters in the UCSC Genome Browser or IGV, plotTSS function is able to generate publish ready figures when list of interested genes are provided and plotting region is specified.</p>
<p>The results of TC annotation can be exported to delimited text files with “exportClustersTable” function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>  <span class="kw">exportClustersTable</span>(myTSSr, <span class="dt">data =</span> <span class="st">"assigned"</span>)</span></code></pre></div>
</li>
<li>
<p>Differential expression analysis</p>
<p>The number of tags at each TSS reflects the number of transcripts initiated at the TSS. Thus, TSS data can be used for expression profiling. With specified sample pairs for comparison, deGene function counts raw tags of each consensus clusters and utilizes the DESeq2 package (Love, Huber et al. 2014) for differential expression analysis.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>  <span class="kw">deGene</span>(myTSSr,<span class="dt">comparePairs=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">"control"</span>,<span class="st">"treat"</span>)), <span class="dt">pval =</span> <span class="fl">0.01</span>,<span class="dt">useMultiCore=</span><span class="ot">FALSE</span>, <span class="dt">numCores=</span><span class="ot">NULL</span>)</span></code></pre></div>
<p>Differential expression analysis results can be visualized by plotDE function which generates a volcano plots. Names of genes differential expressed between the compared pairs are displayed on the dots when the withGeneName argument is set as TRUE.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>  <span class="kw">plotDE</span>(myTSSr, <span class="dt">withGeneName =</span> <span class="st">"TRUE"</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span></code></pre></div>
<p>Differential expression analysis results can also be exported to a text file with exportDETable function.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>  <span class="kw">exportDETable</span>(myTSSr, <span class="dt">data =</span> <span class="st">"sig"</span>)</span></code></pre></div>
</li>
</ul>
<p><img src="https://github.com/Linlab-slu/TSSr/raw/master/vignettes/figures/05_Volcano_plot_v2.png" alt="05_Volcano_plot"></p>
<ul>
<li>
<p>Core promoter shifts</p>
<p>One gene might have multiple core promoters which can be used differently in different samples. TSSr implements degree of shift (Ds) algorithm (Lu and Lin 2019) to quantify the degree of promoter shift across different samples.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>  <span class="kw">shiftPromoter</span>(myTSSr,<span class="dt">comparePairs=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">"control"</span>,<span class="st">"treat"</span>)), <span class="dt">pval =</span> <span class="fl">0.01</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a></span>
<span id="cb41-3"><a href="#cb41-3"></a>  myTSSr<span class="op">@</span>PromoterShift</span>
<span id="cb41-4"><a href="#cb41-4"></a></span>
<span id="cb41-5"><a href="#cb41-5"></a>  <span class="co"># $control_VS_treat</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="co">#          gene                Ds                  pval          padj</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="co">#  1:   YBL017C  16.5567506300711                     0  0.000000e+00</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="co">#  2:   YBR006W -26.3346456757359                     0  0.000000e+00</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  <span class="co">#  3:   YBR023C  18.2077046044299                     0  0.000000e+00</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>  <span class="co">#  4:   YBR039W -27.6613679931366                     0  0.000000e+00</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  <span class="co">#  5:   YBR121C -32.7186775913908                     0  0.000000e+00</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>  <span class="co">#  6:   YBL067C -25.5609100771941 4.82850134420976e-307 2.253301e-305</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>  <span class="co">#  7:   YBL052C  24.6257478761727 7.26364747717188e-223 2.542277e-221</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>  <span class="co">#  8:   YBL061C  23.9226054570548 4.67819852942603e-211 1.455440e-209</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>  <span class="co">#  9: YBR162W-A -3.11046343563838 8.57254730119706e-178 2.400313e-176</span></span>
<span id="cb41-16"><a href="#cb41-16"></a>  <span class="co"># 10:   YBR161W  13.8279474932153 9.82622800918837e-106 2.292787e-104</span></span>
<span id="cb41-17"><a href="#cb41-17"></a>  <span class="co"># 11:   YBL003C -4.19847808240255  5.1964924531945e-103 1.119245e-101</span></span>
<span id="cb41-18"><a href="#cb41-18"></a>  <span class="co"># 12:   YBR225W  13.4149548647111  6.4269334028266e-103 1.285387e-101</span></span>
<span id="cb41-19"><a href="#cb41-19"></a>  <span class="co"># 13:   YAL002W  11.0783513437554  9.36722953965125e-38  1.248964e-36</span></span>
<span id="cb41-20"><a href="#cb41-20"></a>  <span class="co"># 14:   YBL002W  -4.1133471925947  1.79254923091534e-22  1.792549e-21</span></span>
<span id="cb41-21"><a href="#cb41-21"></a>  <span class="co"># 15:   YBR203W  10.6629850364627  7.02368199407009e-21  6.781486e-20</span></span>
<span id="cb41-22"><a href="#cb41-22"></a>  <span class="co"># 16:   YAL054C  -3.1805025752741  1.80946689382427e-16  1.688836e-15</span></span>
<span id="cb41-23"><a href="#cb41-23"></a>  <span class="co"># 17:   YBR295W  9.67791801936358  2.28926136502023e-16  2.067720e-15</span></span>
<span id="cb41-24"><a href="#cb41-24"></a>  <span class="co"># 18:   YBR296C  9.30290660727171  2.36023239071828e-14  2.065203e-13</span></span>
<span id="cb41-25"><a href="#cb41-25"></a>  <span class="co"># 19:   YBR093C -3.40798742790801  2.00916389468933e-13  1.704745e-12</span></span>
<span id="cb41-26"><a href="#cb41-26"></a>  <span class="co"># 20: YBR084C-A  9.11527727298199  2.57854085586531e-13  2.123504e-12</span></span>
<span id="cb41-27"><a href="#cb41-27"></a>  <span class="co"># 21:   YBR184W -15.2971031957146  1.90180856743423e-12  1.521447e-11</span></span>
<span id="cb41-28"><a href="#cb41-28"></a>  <span class="co"># 22:   YBR156C   -15.10487255485  3.10952877910847e-11  2.418522e-10</span></span>
<span id="cb41-29"><a href="#cb41-29"></a>  <span class="co"># 23:   YBL045C  8.74743526840298  2.24860038205826e-10  1.649988e-09</span></span>
<span id="cb41-30"><a href="#cb41-30"></a>  <span class="co"># 24:   YBR211C  8.83205164938185  2.29819756625836e-10  1.649988e-09</span></span>
<span id="cb41-31"><a href="#cb41-31"></a>  <span class="co"># 25:   YBR175W -9.29322141796793  7.46451552866191e-10  5.225161e-09</span></span>
<span id="cb41-32"><a href="#cb41-32"></a>  <span class="co"># 26:   YBR260C  8.59396786414482   6.1189233992215e-09  4.178777e-08</span></span>
<span id="cb41-33"><a href="#cb41-33"></a>  <span class="co"># 27:   YBR015C -1.55009599585459   2.5144638411962e-08  1.676309e-07</span></span>
<span id="cb41-34"><a href="#cb41-34"></a>  <span class="co"># 28:   YBR218C  8.34981937289533  5.06126915693087e-08  3.287460e-07</span></span>
<span id="cb41-35"><a href="#cb41-35"></a>  <span class="co"># 29:   YBR244W  8.30806489068964  5.16600880899288e-08  3.287460e-07</span></span>
<span id="cb41-36"><a href="#cb41-36"></a>  <span class="co"># 30:   YBL054W   2.8341173250082  8.07918244515885e-08  5.027047e-07</span></span>
<span id="cb41-37"><a href="#cb41-37"></a>  <span class="co"># 31: YAL026C-A -9.04035405768231  1.68525949110593e-07  1.003984e-06</span></span>
<span id="cb41-38"><a href="#cb41-38"></a>  <span class="co"># 32:    snR161 -2.50921709668593  4.57553973228071e-07  2.669065e-06</span></span>
<span id="cb41-39"><a href="#cb41-39"></a>  <span class="co"># 33:  tQ(UUG)B   8.4166183829428  2.80004547044555e-06  1.600026e-05</span></span>
<span id="cb41-40"><a href="#cb41-40"></a>  <span class="co"># 34:   YBL040C  7.85978512550703  5.67754708991627e-06  3.179426e-05</span></span>
<span id="cb41-41"><a href="#cb41-41"></a>  <span class="co"># 35:   YBR117C -2.07135794086609  2.15793728644816e-05  1.184750e-04</span></span>
<span id="cb41-42"><a href="#cb41-42"></a>  <span class="co"># 36:   YBL103C  7.60938746583251  3.47531850741136e-05  1.845650e-04</span></span>
<span id="cb41-43"><a href="#cb41-43"></a>  <span class="co"># 37:   YBR270C  -1.7014289300971   3.4935512199854e-05  1.845650e-04</span></span>
<span id="cb41-44"><a href="#cb41-44"></a>  <span class="co"># 38:   YBR008C  1.03566759072034  3.91024884830601e-05  2.027536e-04</span></span>
<span id="cb41-45"><a href="#cb41-45"></a>  <span class="co"># 39:   YBL026W  7.50615085133225  5.64749784425959e-05  2.875090e-04</span></span>
<span id="cb41-46"><a href="#cb41-46"></a>  <span class="co"># 40:   YBL022C 0.792377149588471  7.40429250345774e-05  3.702146e-04</span></span>
<span id="cb41-47"><a href="#cb41-47"></a>  <span class="co"># 41:   YAL062W  7.47110168494036   7.6562991161926e-05  3.760989e-04</span></span>
<span id="cb41-48"><a href="#cb41-48"></a>  <span class="co"># 42:   YAL018C -2.96325319131017                     1  1.000000e+00</span></span>
<span id="cb41-49"><a href="#cb41-49"></a>  <span class="co"># 43:   YBL083C 0.373945070392578                     1  1.000000e+00</span></span>
<span id="cb41-50"><a href="#cb41-50"></a>  <span class="co"># 44: YBR012W-A -2.82952533010526                     1  1.000000e+00</span></span>
<span id="cb41-51"><a href="#cb41-51"></a>  <span class="co"># 45:   YBR300C 0.869273808837717                     1  1.000000e+00</span></span>
<span id="cb41-52"><a href="#cb41-52"></a>  <span class="co">#          gene                Ds                  pval          padj</span></span></code></pre></div>
<p>Below is an example of core promoter shift in gene YBL017C. The two major core promoters are differently used in control and treat samples.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>  <span class="kw">plotTSS</span>(myTSSr,<span class="dt">samples=</span><span class="kw">c</span>(<span class="st">"control"</span>,<span class="st">"treat"</span>),<span class="dt">tssData =</span> <span class="st">"processed"</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  ,<span class="dt">clusters =</span> <span class="st">"assigned"</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>  ,<span class="dt">clusterThreshold =</span> <span class="fl">0.02</span> </span>
<span id="cb42-4"><a href="#cb42-4"></a>  ,<span class="dt">genelist=</span><span class="kw">c</span>(<span class="st">"YBR168W"</span>,<span class="st">"YBL067C"</span>)</span>
<span id="cb42-5"><a href="#cb42-5"></a>  ,<span class="dt">up.dis =</span><span class="dv">500</span>,<span class="dt">down.dis =</span> <span class="dv">100</span>,<span class="dt">yFixed=</span><span class="ot">TRUE</span>)</span></code></pre></div>
</li>
</ul>
<p><img src="https://github.com/Linlab-slu/TSSr/raw/master/vignettes/figures/06_TSS_graphs_v3.png" alt="06_TSS_graphs"></p>
<p>Results of core promoter shift analysis can also be exported to a text file with exportShiftTable function.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>    <span class="kw">exportShiftTable</span>(myTSSr)</span></code></pre></div>
</div>
<div id="7-contact" class="section level2">
<h2 class="hasAnchor">
<a href="#7-contact" class="anchor"></a>7. Contact:</h2>
<p>Zhenguo Lin, PhD</p>
<p>Department of Biology, Saint Louis University, USA.</p>
<p>Email: <a href="mailto:zhenguo.lin@slu.edu" class="email">zhenguo.lin@slu.edu</a></p>
</div>
<div id="8-reference" class="section level2">
<h2 class="hasAnchor">
<a href="#8-reference" class="anchor"></a>8. Reference:</h2>
<p>Arribere, J. A. and W. V. Gilbert (2013). “Roles for transcript leaders in translation and mRNA decay revealed by transcript leader sequencing.” Genome Res 23(6): 977-987.</p>
<p>Cumbie, J. S., M. G. Ivanchenko and M. Megraw (2015). “NanoCAGE-XL and CapFilter: an approach to genome wide identification of high confidence transcription start sites.” BMC Genomics 16: 597.</p>
<p>Cvetesic, N., H. G. Leitch, M. Borkowska, F. Muller, P. Carninci, P. Hajkova and B. Lenhard (2018). “SLIC-CAGE: high-resolution transcription start site mapping using nanogram-levels of total RNA.” Genome Res 28(12): 1943-1956.</p>
<p>Kruesi, W. S., L. J. Core, C. T. Waters, J. T. Lis and B. J. Meyer (2013). “Condensin controls recruitment of RNA polymerase II to achieve nematode X-chromosome dosage compensation.” Elife 2: e00808.</p>
<p>Mahat, D. B., H. Kwak, G. T. Booth, I. H. Jonkers, C. G. Danko, R. K. Patel, C. T. Waters, K. Munson, L. J. Core and J. T. Lis (2016). “Base-pair-resolution genome-wide mapping of active RNA polymerases using precision nuclear run-on (PRO-seq).” Nat Protoc 11(8): 1455-1476.</p>
<p>Mahat, D. B., H. Kwak, G. T. Booth, I. H. Jonkers, C. G. Danko, R. K. Patel, C. T. Waters, K. Munson, L. J. Core and J. T. Lis (2016). “Base-pair-resolution genome-wide mapping of active RNA polymerases using precision nuclear run-on (PRO-seq).” Nat Protoc 11(8): 1455-1476.</p>
<p>Malabat, C., F. Feuerbach, L. Ma, C. Saveanu and A. Jacquier (2015). “Quality control of transcription start site selection by nonsense-mediated-mRNA decay.” Elife 4.</p>
<p>Murata, M., H. Nishiyori-Sueki, M. Kojima-Ishiyama, P. Carninci, Y. Hayashizaki and M. Itoh (2014). “Detecting expressed genes using CAGE.” Methods Mol Biol 1164: 67-85.</p>
<p>Pelechano, V., W. Wei and L. M. Steinmetz (2013). “Extensive transcriptional heterogeneity revealed by isoform profiling.” Nature 497(7447): 127-131.</p>
<p>Takahashi, H., T. Lassmann, M. Murata and P. Carninci (2012). “5’ end-centered expression profiling using cap-analysis gene expression and next-generation sequencing.” Nat Protoc 7(3): 542-561.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/Linlab-slu/TSSr/">https://​github.com/​Linlab-slu/​TSSr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/Linlab-slu/TSSr/issues">https://​github.com/​Linlab-slu/​TSSr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing TSSr</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Zhaolian Lu <br><small class="roles"> Author, compiler </small> <a href="https://orcid.org/0000-0001-5002-7007" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Keenan Berry <br><small class="roles"> Author, compiler </small>  </li>
<li>Zhenbin Hu <br><small class="roles"> Author, contributor </small>  </li>
<li>Yu Zhan <br><small class="roles"> Author, contributor </small>  </li>
<li>Tae-Hyuk (Ted) Ahn <br><small class="roles"> Author, copyright holder </small>  </li>
<li>Zhenguo Lin <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-8400-9138" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Zhaolian Lu, Keenan Berry, Zhenbin Hu, Yu Zhan, Tae-Hyuk (Ted) Ahn, Zhenguo Lin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
